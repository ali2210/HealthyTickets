<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300&family=Roboto+Mono:wght@500&display=swap"
    rel="stylesheet">
  <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/dashboard.css">
  <title>WizDwarfs</title>
</head>

<body>
  <div class='main-dashboard-div'>
		<nav class="navbar navbar-expand-md navbar-light custom-navbar">
		  <a class="navbar-brand" href="#">
			<img src="/images/logo.png" alt="Logo" class="logo">
		  </a>
		  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown">
			<span class="navbar-toggler-icon"></span>
		  </button>
		  <div class="collapse navbar-collapse" id="navbarNavDropdown">
			<ul class="navbar-nav">
			  <li class="nav-item active pl-3">
				<a class="nav-link" href="/home">
				  <i class="fa fa-home icon-light" aria-hidden="true"></i>
				  Home
				</a>
			  </li>
			  <li class="nav-item dropdown pl-3">
				<a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown"
				  aria-haspopup="true" aria-expanded="false">
				  <i class="fa fa-handshake-o" aria-hidden="true"></i>
				  Business
				</a>
				<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
				  <!-- <a class="dropdown-item active" href="/open"><i class="fa fa-handshake-o " aria-hidden="true"></i> Premium </a>
				  <a class="dropdown-item" href="/"> <i class="fa fa-briefcase" aria-hidden="true"> Service </i>
				  </a>-->
				  <div class="card" style="width: 19rem;height: 22rem;position: relative;">
					<img class="images"
					  src="https://physicsworld.com/wp-content/uploads/2019/08/Quantum-teleportation.jpg"
					  alt="paint_the_world">
					<div class="card-body card-body-text">
					  <h5 class="card-title"> Paint the World </h5>
					  <p class="card-text"> 
						  "Beause the onces who are crazy enough to think that they can change the world, are the ones who do."
					  </p>
					</div>
				  </div>
				</div>
			  </li>
			  <li class="nav-item dropdown pl-3">
				<a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown"
				  aria-haspopup="true" aria-expanded="false">
				  <i class="fa fa-user-circle-o" aria-hidden="true"></i>
				  Admin
				</a>
				<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
				  <a class="dropdown-item" href="/dashboard/profile"><i class="fa fa-sliders" aria-hidden="true"></i>
					Edit-Profile </a>
				  <a class="dropdown-item" href="/logout"><i class="fa fa-sign-out icon icon-light"
					  aria-hidden="true"></i>Logout</a>
					  
				  <div class="card" style="width: 25rem; height: 23rem; position: relative;">
					<img class="img-class"
					  src="https://6lli539m39y3hpkelqsm3c2fg-wpengine.netdna-ssl.com/wp-content/uploads/2019/01/tech-abstract_shutterstock-1191298288_700x-675x380.jpg"
					  alt="Chase dreams">
					<div class="card-body description">
					  <h5 class="card-title"> Masterpiece  </h5>
					  <p class="card-text"> The smallest feline is a masterpiece </p>
					</div>
				  </div>
			  </li>
			</ul>
		  </div>
		</nav>


    <form enctype="multipart/form-data" action="/dashboard" method="post" class="dashboard-form">
      <div class="container main-container">
        <div class="infection-field">
          <h4>Choose the type of infection</h4>
          <select class="custom-select" id="inputGroupSelect01" name="choose" required>
            <option selected>  Genome Tracer </option>
            <option value="1"> COVID-19 </option>
            <option value="2"> Flvi Dengue </option>
            <option value="3"> Bambli Ebola </option>
            <option value="4"> Zika Virus </option>
            <option value="5"> MERSS </option>
          </select>
        </div>
        <div class="file-upload-field">
          <input type="file" id="file" id="exampleFormControlFile1" name="fileSeq" />
          <label for="file" class="btn-3">
            <span class="selected-file">
              <i class="fa fa-file-text-o icon" aria-hidden="true"></i>
              Upload Your Gnome
            </span>
          </label>
        </div>
        <div class="sign">
          <label>
            <input type="checkbox" id="signed" data-toggle="toggle" data-on="<i class='fa fa-user' aria-hidden='true'></i>" data-off="<i class='fa fa-user-secret' aria-hidden='true'></i>"data-onstyle="success" data-offstyle="danger" data-style="mode" name="signed"/>
            Signed Message?
          </label>
          <input class="signed_message" name="status" />
          <button class="btn btn-light verified" type="button"></button>
          <input class="public_address" name="address"/>
        </div>
        <!-- critical -->
        <!-- <p>
            <button type="button" class="btn btn-primary Location" data-toggle="collapse" data-target="#location">
              <i class="fa fa-compass" aria-hidden="true"></i> Add Location
            </button>
        </p>
            <div class="collapse" id="location">
              <div class="card card-body">
                <div class="input-group mb-3">
                  <div class="input-group-prepend mr-2">
                    <span><i class="fa fa-check d-none verified-icon" aria-hidden="true"></i></span>
                    <span><i class="fa fa-times d-none unveriied-icon" aria-hidden="true"></i></span>
                  </div>
                  <input type="text" name="country" placeholder="Country" id="homeland">
                  <button type="button" class="btn btn-primary ml-2" id="Homeland" onclick="VerifyCountryStatus()"/>Verify
                </div>
                <div class="input-group mb-3">
                  <div class="input-group-prepend mr-2">
                    <span><i class="fa fa-check d-none verified-icon" aria-hidden="true"></i></span>
                    <span><i class="fa fa-times d-none unveriied-icon" aria-hidden="true"></i></span>
                  </div>
                  <input type="text" name="city" placeholder="City" id="mytown">
                  <button type="button" class="btn btn-primary ml-2" id="Hometown" onclick="VerifyCityStatus()"/>Verify
                </div>
                <div class="input-group mb-3">
                  <div class="input-group-prepend mr-2">
                    <span><i class="fa fa-check d-none verified-icon" aria-hidden="true"></i></span>
                    <span><i class="fa fa-times d-none unveriied-icon" aria-hidden="true"></i></span>
                  </div>
                  <input type="text" name="postal" placeholder="Postal" id="area">
                  <button type="button" class="btn btn-primary ml-2" id="buttonTown" onclick="PostalStatus()"/>Verify
                </div>
                <div class="input-group mb-3">
                  <div class="input-group-prepend mr-2">
                    <span><i class="fa fa-check d-none verified-icon" aria-hidden="true"></i></span>
                    <span><i class="fa fa-times d-none unveriied-icon" aria-hidden="true"></i></span>
                  </div>
                  <input type="text" name="street" placeholder="Street Address" id="address">
                  <button type="button" class="btn btn-primary ml-2" id="streetAddress" onclick="StreetStatus()"/>Verify
                </div>
                <div class="input-group mb-3">
                  <div class="input-group-prepend mr-2">
                    <span><i class="fa fa-check d-none verified-icon" aria-hidden="true"></i></span>
                    <span><i class="fa fa-times d-none unveriied-icon" aria-hidden="true"></i></span>
                  </div>
                  <input type="number" name="route" placeholder="Street Number (115)" id="snum">
                  <button type="button" class="btn btn-primary ml-2" id="snumButton" onclick="NumStatus()"/>Verify
                </div>
                <div class="input-group mb-3">
                  <div class="input-group-prepend mr-2">
                    <span><i class="fa fa-check d-none verified-icon" aria-hidden="true"></i></span>
                    <span><i class="fa fa-times d-none unveriied-icon" aria-hidden="true"></i></span>
                  </div>
                  <input type="text" name="state" placeholder="State" id="state">
                  <button type="button" class="btn btn-primary ml-2" id="stateButton" onclick="StateStatus()"/>Verify
                </div>
                  <div class="input-group mb-3">
                    <button type="button" class="btn btn-primary ml-4" id="saveButton" onclick="SaveLocation()"/>Save Location
                  </div>
              </div>
            </div> -->
            <div class="location-div">
              <button class="btn btn-light" type="button" title="press marker if you want to activate your current location">
                <i class="fa fa-map-marker" aria-hidden="true"></i>
              </button>
              <input type="text" class="small-div" name="geo-marker" id="geo-marker" readonly/>
            </div>
        <button type="submit" class="btn btn-success mb-2 submit-button" data-toggle="popover"
          title="submit your genetic file ">Submit</button>
    </form>
  </div>
  </div>
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>
  <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/fortmatic@latest/dist/fortmatic.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.0.0-beta.34/dist/web3.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.0.0-beta.34/dist/web3.min.js"></script>
  <script src="/js/dashboard.js"></script>
  <script src="/js/additional.js"></script>
  <script type="text/javascript">

    const parent_div = document.getElementsByClassName('sign')[0];
    const para_div = document.getElementsByClassName('signed_message')[0];
    const verifiedBtn = document.getElementsByClassName('verified')[0];
    const submitBtn = document.getElementsByClassName('submit-button')[0];
    console.log(para_div, parent_div);
    
    $('#signed').on('change', () =>{
  
      console.log("props:" , ($('#signed').prop('checked')));
      if ($('#signed').prop('checked', true)){
    
      // create div, icon and button
      const div = document.createElement('div');
      const icon = document.createElement('i');
    

      // adjust button props
      verifiedBtn.id  = 'fortmatic';
      verifiedBtn.style.visibility = 'visible';
      verifiedBtn.style.position ='relative';
      verifiedBtn.style.top = '-3px';
      verifiedBtn.style.left = '-222px';
      verifiedBtn.style.color = 'lawngreen';
      verifiedBtn.style.boxShadow = '1px 1px whitesmoke';
      verifiedBtn.style.transformStyle = 'preserve-3d';
      verifiedBtn.style.zIndex = '2';

      //adjust icon properties
      icon.className = 'fa fa-check-circle';
      icon.ariaHidden = true;

      // icon render
      verifiedBtn.appendChild(icon);


      // submit button props
      submitBtn.style.marginTop = '17px';
      

      // user action message
      para_div.style.visibility = 'visible';
      para_div.value = 'The message have been signed. Please verify your message.';
      para_div.style.position = 'relative';
      para_div.style.width = '433px';
      para_div.style.left = '41px';
      para_div.style.border = '2px whitesmoke none';
      para_div.style.borderRadius = '13px';
      para_div.style.top = '-31px';
     
      //  newly created div render
      div.className = 'actions';
      div.appendChild(para_div);
      div.appendChild(verifiedBtn);

      // message props
      parent_div.style.position = 'relative';
      parent_div.style.left = '15px';
      parent_div.style.width = '500px';
      parent_div.style.boxShadow = '5px 5px whitesmoke';
      parent_div.style.zIndex = '2';
      parent_div.style.borderRadius = '48px';
      parent_div.style.top = '-24px';
      parent_div.style.display = 'grid'; 
    
      // message box render
      parent_div.appendChild(div);
    }
      if ($('#signed').prop('checked', false)) {
        parent_div.children[0].style.visibility = 'hidden';
        console.log("checked false");
      }
});
  </script>
  <script type="text/javascript">
    
    // verified button 
    const vbtn = document.getElementsByClassName('verified')[0];
    const address = document.getElementsByClassName('public_address')[0];
    
    // Keys
    const FORTMATIC_API_KEY = 'pk_test_1089727802E62684';
    const FORTMATIC_API_Prod = 'pk_live_59E7F894747B33ED';
    const ToAddress = '0x1E919035e637e36eC998c2568bA0697D11133a8f'; 
    console.log("verified :", vbtn);
    
    
    // verified button event
    vbtn.addEventListener('click', ()=>{
      
      // additional params and objects such as fortmatic and web3js
      let fsdk = new Fortmatic(FORTMATIC_API_KEY);
      let web3eth = new Web3(fsdk.getProvider());
      console.log("web3eth :", web3eth);

      // ether balance pay for signed message
      let Tovalue = web3eth.utils.toWei('0.0007', 'ether');
      let accountLogin;
      
      // if user have fortmatic access 
      if(fsdk.getProvider().isFortmatic){
        console.log("weldone fortmatic ..");
        
        // then active fortmatic api
        // web3eth.currentProvider.enable = true;
        
        fsdk.user.login().then(()=>{
        
            // user login credentials 
            accountLogin = fsdk.user.isLoggedIn();
            // user fortmatic account created from user 'email address'
        
            fsdk.configure({
              primaryLoginOption: 'email' 
            }).then(()=>{
              
              // if user have email account created and also login then
            if (accountLogin){

              console.log("fortmatic account login successfully:", accountLogin);
              // verified button props
              vbtn.style.visibility = 'hidden';

              // input props
              address.style.visibility = 'visible';
              address.style.position = 'absolute';
              address.style.zIndex = '2';
              address.style.top = '44px';
              address.style.left = '74px';
              address.style.borderRadius = '12px';
              address.style.border = '2px whitesmoke none';
              address.style.boxShadow = '5px 5px whitesmoke';
              address.style.transformStyle = 'preserve-3d';
              address.style.top = '79px';
              address.style.width = '416px';
              address.readOnly = true;
              
              // get user account and open wallet for transaction 
              web3eth.eth.getAccounts().then((account)=>{
              
                // transact request object
                
                let tnxParam = {
                  from: account[0],
                  to : ToAddress,
                  value : Tovalue,
                };
              
                // get coinbase addresss for market and other transact activities
                web3eth.eth.getCoinbase().then((coinbase)=>{
                 console.log("fortmatic account linkin with coinbase:", coinbase);
                 console.log("Fortmatic address:", account, tnxParam);
                 address.value = tnxParam.from;
                  fsdk.user.deposit().then(()=>{
                    web3eth.eth.sendTransaction(tnxParam).once('transactionHash', (hash) => { 
                    }).once('receipt', (receipt) => { 
                      console.log("user recipt generate via fortmatic wallet:", receipt); 
                    });
                  }).catch(()=>{
                    console.log("Transaction through your account is not allowed. Please contact wizdwarfs@gmail.com if problem remain!");
                    alert("Transaction through your account is not allowed. Please contact wizdwarfs@gmail.com if problem remain!")
                  });
                }).catch((error)=>{
                 console.log("fortmatic account not link with coinbase:", error);
                 alert("Fortmatic Account not linkin by coinbase, which means no exchange of commodities");
                });
              }).catch(()=>{
                console.log(" Wrong Credentials submitted ");
                alert(" Wrong Credentials submitted ");
              });
            }
          });      
        }).catch(()=>{
            console.log("account credentials failed:" + !fsdk.user.isLoggedIn());
            alert("No Credentials submitted !");   
        });
    }
  });
  </script>
</body>

</html>